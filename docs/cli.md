# CLI Reference

This document provides a comprehensive reference for the Insight Ingenious Command Line Interface (CLI).

## Overview

The Insight Ingenious CLI (`ingen`) is a powerful tool that allows you to:

- Initialize new projects
- Run the REST API server
- Launch the prompt tuner
- Manage project resources

## Basic Usage

```bash
ingen [COMMAND] [OPTIONS]
```

Use the `--help` option to get information about available commands:

```bash
ingen --help
```

## Commands

### `run`

Starts the REST API server.

```bash
ingen run [OPTIONS]
```

**Options:**
- `--project-dir TEXT`: The path to the config file.
- `--profile-dir TEXT`: The path to the profiles file.
- `--host TEXT`: The host to bind the server to.
- `--port INTEGER`: The port to bind the server to.

**Example:**
```bash
ingen run --host 0.0.0.0 --port 8000
```

### `init`

Generates template folders for a new project using the Ingenious framework.

```bash
ingen init
```

This command creates the following:
- Template folders for your project
- A basic `config.yml` file
- A `.gitignore` file
- A `profiles.yml` file in the `~/.ingenious` directory

### `run-prompt-tuner`

Runs the prompt tuner web application.

```bash
ingen run-prompt-tuner
```

This starts a Flask application for tuning prompts, accessible at `http://0.0.0.0:80` by default.

## Environment Variables

The CLI uses several environment variables:

- `INGENIOUS_PROJECT_PATH`: Path to your project's configuration file
- `INGENIOUS_PROFILE_PATH`: Path to your profiles configuration file
- `INGENIOUS_WORKING_DIR`: Working directory for the application

Example:

```bash
export INGENIOUS_PROJECT_PATH=/path/to/config.yml
export INGENIOUS_PROFILE_PATH=~/.ingenious/profiles.yml
export INGENIOUS_WORKING_DIR=/path/to/project
```

## Common Workflows

### Setting Up a New Project

```bash
# Install the package
uv venv
uv pip install -e .

# Initialize a new project
ingen init

# Edit configuration files
# - config.yml in the current directory
# - ~/.ingenious/profiles.yml

# Run tests to verify setup
ingen run-test-batch
```

### Starting the API Server

```bash
# Start the API server
ingen run --host 127.0.0.1 --port 8000
```

### Tuning Prompts

```bash
# Start the prompt tuner
ingen run-prompt-tuner
```

Then access the prompt tuner at `http://0.0.0.0:80` in your browser.

## Advanced Features

### Debugging

For verbose output, use the `--log-level` option:

```bash
ingen run-test-batch --log-level DEBUG
```

### Continuous Integration

In CI environments, you can use the CLI non-interactively:

```bash
export INGENIOUS_PROJECT_PATH=/path/to/config.yml
export INGENIOUS_PROFILE_PATH=/path/to/profiles.yml
ingen run-test-batch --log-level INFO
```

## Error Handling

The CLI provides meaningful error messages and exit codes. Common errors include:

- Missing configuration files
- Invalid configuration
- Network connectivity issues
- Authentication failures

If you encounter errors, check the logs for detailed information.

## Tips and Best Practices

1. **Environment Consistency**: Use the same environment variables across all CLI commands for consistent behavior.

2. **Testing**: Run tests after making changes to ensure everything works as expected.

3. **Configuration Templates**: Use the templates generated by `init` as a starting point for your configuration.

4. **Prompt Tuning**: Use the prompt tuner for iterative development of agent prompts.

5. **Logging Levels**: Adjust logging levels based on your needs. Use INFO for general information, DEBUG for verbose output, and WARNING for normal operation.

## Extending the CLI

You can extend the CLI by adding custom commands to your extensions. Here's an example:

```python
# ingenious_extensions/cli.py
import typer
from ingenious.cli import app

@app.command()
def custom_command():
    """A custom command added by an extension."""
    print("Running custom command")
```

Import your extension CLI commands in your application startup code to make them available.
